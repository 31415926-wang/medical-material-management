import{d as I,r as w,f as v,m as t,u as o,I as G,v as s,e as _,g as J,l as e,z as u,t as V,C as j,p as N,_ as K,b as X,k as R,P as $,F as L,R as Y,D as M,Q as q,N as Z}from"./index-dbcce48f.js";import{i as ee}from"./initCrud-4302dad7.js";import{p as k}from"./provide-26b30996.js";import{b as C,P as Q,e as W,G as H,f as te}from"./shareData-091bd6ed.js";const ae={class:"dialog-box"},le=I({__name:"dialog",props:{dialogVisible:{type:Boolean},infoItem:{}},emits:["update:dialogVisible"],setup(A,{emit:x}){let z=A,m=x,i=w(),b=w(1),S=w(0);const f=async()=>{G.openLoading(document.querySelector(".dialog-box"));let c=await k.getProvideStocksDetail(z.infoItem.id,b.value);G.closeLoading(),i.value=c.data,S.value=c.data.total};return(c,r)=>{const g=s("el-tag"),p=s("el-form-item"),y=s("el-col"),P=s("el-row"),D=s("el-form"),T=s("el-card"),O=s("el-step"),U=s("el-steps"),h=s("el-table-column"),B=s("el-table"),a=s("el-pagination"),l=s("el-dialog");return _(),v(l,{modelValue:c.dialogVisible,"onUpdate:modelValue":r[1]||(r[1]=d=>o(m)("update:dialogVisible",d)),title:"发放明细",onOpen:f,width:"45%"},{default:t(()=>{var d,E,F;return[J("div",ae,[e(T,{class:"el-card"},{default:t(()=>[e(D,{"label-width":"85px"},{default:t(()=>[e(P,{style:{"margin-bottom":"10px"}},{default:t(()=>[e(y,{span:12},{default:t(()=>[e(p,{label:"省区市:"},{default:t(()=>[e(g,{size:"large"},{default:t(()=>{var n;return[u(V((n=o(i))==null?void 0:n.consumerVO.address),1)]}),_:1})]),_:1})]),_:1}),e(y,{span:12},{default:t(()=>[e(p,{label:"具体位置:"},{default:t(()=>[e(g,{size:"large"},{default:t(()=>{var n;return[u(V((n=o(i))==null?void 0:n.consumerVO.name),1)]}),_:1})]),_:1})]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(y,{span:12},{default:t(()=>[e(p,{label:"联系人:"},{default:t(()=>[e(g,{size:"large"},{default:t(()=>{var n;return[u(V((n=o(i))==null?void 0:n.consumerVO.contact),1)]}),_:1})]),_:1})]),_:1}),e(y,{span:12},{default:t(()=>[e(p,{label:"电话:"},{default:t(()=>[e(g,{size:"large"},{default:t(()=>{var n;return[u(V((n=o(i))==null?void 0:n.consumerVO.phone),1)]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),((d=o(i))==null?void 0:d.status)!=o(C).recycle?(_(),v(U,{key:0,space:200,active:((E=o(i))==null?void 0:E.status)==o(C).Pending?2:3,"finish-status":"success",simple:"",class:"steps"},{default:t(()=>[e(O,{title:"提交发放单"}),e(O,{title:"审核发放单"}),e(O,{title:"成功发放"})]),_:1},8,["active"])):j("",!0),e(B,{data:(F=o(i))==null?void 0:F.itemVOS,style:{width:"100%"},"cell-style":{height:"70px"}},{default:t(()=>[e(h,{prop:"name",label:"名称"}),e(h,{prop:"pnum",label:"商品编号"}),e(h,{prop:"model",label:"规格"}),e(h,{prop:"count",label:"数量",width:"100"}),e(h,{prop:"unit",label:"单位",width:"100"})]),_:1},8,["data"]),e(a,{background:"","current-page":o(b),"onUpdate:currentPage":r[0]||(r[0]=n=>N(b)?b.value=n:b=n),onCurrentChange:f,layout:"prev, pager, next,total",total:o(S),"page-size":3},null,8,["current-page","total"])])]}),_:1},8,["modelValue"])}}});const oe=K(le,[["__scopeId","data-v-980fc70b"]]),ue=I({__name:"index",setup(A){let x=w(),z=X([{prop:"outNum",label:"发放单号",searchType:"input",width:190},{prop:"type",label:"发放类型",rebuild:!0,width:120},{prop:"priority",label:"紧急程度",rebuild:!0,width:190},{prop:"name",label:"发放地点"},{prop:"productNumber",label:"总数",sortable:!0,width:75},{prop:"phone",label:"联系方式",width:130},{prop:"status",label:"状态",rebuild:!0,width:120},{prop:"operator",label:"操作员",width:130}]);ee(x,{title:"物资发放",apiMethod:k},z);let m=w(!1),i=w();const b=c=>{let r;switch(c){case 0:r="success";break;case 1:r="danger";break;case 2:r="warning";break;case 3:r="info";break;case 4:r="primary";break}return r},S=c=>{let r;switch(c){case 0:r="primary";break;case 1:r="danger";break;case 2:r="warning";break}return r},f=async(c,r)=>{switch(c){case 1:await k.removeItem(r.id);break;case 2:await k.backItem(r.id);break;case 3:await k.passItem(r.id);break;case 4:await k.deleteItem(r.id);break}Z("success","操作成功"),x.value.hookCrudObject.getData()};return(c,r)=>{const g=s("router-link"),p=s("el-button"),y=s("el-option"),P=s("el-select"),D=s("el-form-item"),T=s("el-tag"),O=s("el-rate"),U=s("el-popconfirm"),h=s("CrudTable"),B=Y("auth");return _(),R(L,null,[$((_(),v(g,{to:"/home"},{default:t(()=>[u("test用户才看得到")]),_:1})),[[B,["user:status","productCategory:add"]]]),e(h,{ref_key:"CrudTableRef",ref:x,needOperate:!0,customOperate:!0,operateColWidth:210,defaultToolBtList:["export"]},{batchSlot:t(()=>[e(g,{to:"/inventory/addProvide",style:{"margin-right":"12px"}},{default:t(()=>[e(p,{type:"primary",icon:"Plus"},{default:t(()=>[u("发放")]),_:1})]),_:1})]),"search-custom":t(({scope:a})=>[e(D,{label:"发放类型"},{default:t(()=>[e(P,{modelValue:a.searchParam.type,"onUpdate:modelValue":l=>a.searchParam.type=l,placeholder:"请选择发放类型",clearable:""},{default:t(()=>[(_(!0),R(L,null,M(o(Q),l=>(_(),v(y,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(D,{label:"物资状态"},{default:t(()=>[e(P,{modelValue:a.searchParam.status,"onUpdate:modelValue":l=>a.searchParam.status=l,placeholder:"请选择物资状态",clearable:""},{default:t(()=>[(_(!0),R(L,null,M(o(W),l=>(_(),v(y,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),typeCol:t(({scope:a})=>{var l;return[e(T,{type:b((l=a.row)==null?void 0:l.type)},{default:t(()=>{var d;return[u(V(o(H)((d=a.row)==null?void 0:d.type,o(Q))),1)]}),_:2},1032,["type"])]}),statusCol:t(({scope:a})=>{var l;return[e(T,{type:S((l=a.row)==null?void 0:l.status)},{default:t(()=>{var d;return[u(V(o(H)((d=a.row)==null?void 0:d.status,o(W))),1)]}),_:2},1032,["type"])]}),priorityCol:t(({scope:a})=>[e(O,{disabled:!0,modelValue:a.row.priority,"onUpdate:modelValue":l=>a.row.priority=l,"show-text":"",texts:o(te).map(l=>l.label)},null,8,["modelValue","onUpdate:modelValue","texts"])]),operateExpand:t(({rowInfo:a})=>[e(p,{text:"",type:"primary",class:"mini",icon:"View",onClick:l=>{N(m)?m.value=!0:m=!0,N(i)?i.value=a:i=a}},{default:t(()=>[u("明细")]),_:2},1032,["onClick"]),$(e(p,{text:"",type:"primary",class:"mini",icon:"CircleCheck",onClick:l=>f(3,a)},{default:t(()=>[u("通过")]),_:2},1032,["onClick"]),[[q,a.status==o(C).Pending]]),$(e(p,{text:"",type:"primary",class:"mini",icon:"Refresh",onClick:l=>f(2,a)},{default:t(()=>[u("恢复")]),_:2},1032,["onClick"]),[[q,a.status==o(C).recycle]]),a.status==o(C).recycle?(_(),v(U,{key:0,title:"确定永久删除该记录吗？",onConfirm:l=>f(4,a)},{reference:t(()=>[e(p,{text:"",type:"primary",class:"mini",icon:"Delete"},{default:t(()=>[u("永久删除")]),_:1})]),_:2},1032,["onConfirm"])):j("",!0),a.status!=o(C).recycle?(_(),v(U,{key:1,title:"确定加入回收站吗？",onConfirm:l=>f(1,a)},{reference:t(()=>[e(p,{text:"",type:"primary",class:"mini",icon:"Delete"},{default:t(()=>[u("回收站")]),_:1})]),_:2},1032,["onConfirm"])):j("",!0)]),_:1},512),e(oe,{dialogVisible:o(m),"onUpdate:dialogVisible":r[0]||(r[0]=a=>N(m)?m.value=a:m=a),infoItem:o(i)},null,8,["dialogVisible","infoItem"])],64)}}});export{ue as default};
