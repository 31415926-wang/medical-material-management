import{d as W,r as V,f as x,m as t,u as r,G as I,v as n,e as f,g as J,l as e,z as d,t as O,D as z,p as D,_ as Q,b as X,w as L,k as M,F as R,K as H,O as G,P as E,M as Z}from"./index-d4a5a55b.js";import{i as ee}from"./initCrud-181af38c.js";import{s as w}from"./storage-5cecb3d3.js";import{b as T,A as F,c as q,G as K}from"./shareData-091bd6ed.js";const te={class:"dialog-box"},ae=W({__name:"dialog",props:{dialogVisible:{type:Boolean},infoItem:{}},emits:["update:dialogVisible"],setup(B,{emit:p}){let U=B,_=p,c=V(),y=V(1),P=V(0);const S=async()=>{I.openLoading(document.querySelector(".dialog-box"));let m=await w.getAddStocksDetail(U.infoItem.id,y.value);I.closeLoading(),c.value=m.data,P.value=m.data.total};return(m,b)=>{const s=n("el-tag"),l=n("el-form-item"),i=n("el-col"),v=n("el-row"),k=n("el-form"),j=n("el-card"),C=n("el-step"),Y=n("el-steps"),g=n("el-table-column"),N=n("el-table"),A=n("el-pagination"),o=n("el-dialog");return f(),x(o,{modelValue:m.dialogVisible,"onUpdate:modelValue":b[1]||(b[1]=a=>r(_)("update:dialogVisible",a)),title:"入库明细",onOpen:S,width:"45%"},{default:t(()=>{var a,h,$;return[J("div",te,[e(j,{class:"el-card"},{default:t(()=>[e(k,{"label-width":"85px"},{default:t(()=>[e(v,{style:{"margin-bottom":"10px"}},{default:t(()=>[e(i,{span:12},{default:t(()=>[e(l,{label:"省区市:"},{default:t(()=>[e(s,{size:"large"},{default:t(()=>{var u;return[d(O((u=r(c))==null?void 0:u.supplierVO.address),1)]}),_:1})]),_:1})]),_:1}),e(i,{span:12},{default:t(()=>[e(l,{label:"具体位置:"},{default:t(()=>[e(s,{size:"large"},{default:t(()=>{var u;return[d(O((u=r(c))==null?void 0:u.supplierVO.name),1)]}),_:1})]),_:1})]),_:1})]),_:1}),e(v,null,{default:t(()=>[e(i,{span:12},{default:t(()=>[e(l,{label:"联系人:"},{default:t(()=>[e(s,{size:"large"},{default:t(()=>{var u;return[d(O((u=r(c))==null?void 0:u.supplierVO.contact),1)]}),_:1})]),_:1})]),_:1}),e(i,{span:12},{default:t(()=>[e(l,{label:"电话:"},{default:t(()=>[e(s,{size:"large"},{default:t(()=>{var u;return[d(O((u=r(c))==null?void 0:u.supplierVO.phone),1)]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),((a=r(c))==null?void 0:a.status)!=r(T).recycle?(f(),x(Y,{key:0,space:200,active:((h=r(c))==null?void 0:h.status)==r(T).Pending?2:3,"finish-status":"success",simple:"",class:"steps"},{default:t(()=>[e(C,{title:"提交入库单"}),e(C,{title:"审核入库单"}),e(C,{title:"进入库存"})]),_:1},8,["active"])):z("",!0),e(N,{data:($=r(c))==null?void 0:$.itemVOS,style:{width:"100%"},"cell-style":{height:"70px"}},{default:t(()=>[e(g,{prop:"name",label:"名称"}),e(g,{prop:"pnum",label:"商品编号"}),e(g,{prop:"model",label:"规格"}),e(g,{prop:"count",label:"数量",width:"100"}),e(g,{prop:"unit",label:"单位",width:"100"})]),_:1},8,["data"]),e(A,{background:"","current-page":r(y),"onUpdate:currentPage":b[0]||(b[0]=u=>D(y)?y.value=u:y=u),onCurrentChange:S,layout:"prev, pager, next,total",total:r(P),"page-size":3},null,8,["current-page","total"])])]}),_:1},8,["modelValue"])}}});const le=Q(ae,[["__scopeId","data-v-1c5180dd"]]),oe=J("br",null,null,-1),ue=W({__name:"index",setup(B){let p=V(),U=X([{prop:"inNum",label:"入库单号",searchType:"input",width:220},{prop:"type",label:"物资类型",rebuild:!0,width:120},{prop:"productNumber",label:"数量",sortable:!0,width:110},{prop:"phone",label:"联系方式"},{prop:"status",label:"状态",rebuild:!0,width:120},{prop:"operator",label:"操作员"},{prop:"supplierName",label:"物资提供方"},{prop:"createTime",label:"入库时间",sortable:!0}]);ee(p,{title:"物资入库",apiMethod:w},U);let _=V(!1),c=V();const y=s=>{let l;switch(s){case 1:l="success";break;case 2:l="primary";break;case 3:l="primary";break;case 4:l="warning";break}return l},P=s=>{let l;switch(s){case 0:l="primary";break;case 1:l="danger";break;case 2:l="warning";break}return l},S=s=>s.getTime()>Date.now();let m=V("");L(m,s=>{s==null?(p.value.hookCrudObject.crudInfo.value.searchParam.startTime="",p.value.hookCrudObject.crudInfo.value.searchParam.endTime=""):(p.value.hookCrudObject.crudInfo.value.searchParam.startTime=s[0],p.value.hookCrudObject.crudInfo.value.searchParam.endTime=s[1]),console.log("查询参数",p.value.hookCrudObject.crudInfo.value.searchParam)}),L(()=>{var s,l,i,v,k;return(k=(v=(i=(l=(s=p.value)==null?void 0:s.hookCrudObject)==null?void 0:l.crudInfo)==null?void 0:i.option)==null?void 0:v.searchParam)==null?void 0:k.startTime},s=>{s||(m.value="")});const b=async(s,l)=>{switch(s){case 1:await w.removeItem(l.id);break;case 2:await w.backItem(l.id);break;case 3:await w.passItem(l.id);break;case 4:await w.deleteItem(l.id);break}Z("success","操作成功"),p.value.hookCrudObject.getData()};return(s,l)=>{const i=n("el-button"),v=n("router-link"),k=n("el-option"),j=n("el-select"),C=n("el-form-item"),Y=n("el-date-picker"),g=n("el-tag"),N=n("el-popconfirm"),A=n("CrudTable");return f(),M(R,null,[e(A,{ref_key:"CrudTableRef",ref:p,needOperate:!0,customOperate:!0,operateColWidth:210,defaultToolBtList:["export"]},{batchSlot:t(()=>[e(v,{to:"/inventory/addStocks",style:{"margin-right":"12px"}},{default:t(()=>[e(i,{type:"primary",icon:"Plus"},{default:t(()=>[d("入库")]),_:1})]),_:1})]),"search-custom":t(({scope:o})=>[e(C,{label:"入库类型"},{default:t(()=>[e(j,{modelValue:o.searchParam.type,"onUpdate:modelValue":a=>o.searchParam.type=a,placeholder:"请选择入库类型",clearable:""},{default:t(()=>[(f(!0),M(R,null,H(r(F),a=>(f(),x(k,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(C,{label:"物资状态"},{default:t(()=>[e(j,{modelValue:o.searchParam.status,"onUpdate:modelValue":a=>o.searchParam.status=a,placeholder:"请选择物资状态",clearable:""},{default:t(()=>[(f(!0),M(R,null,H(r(q),a=>(f(),x(k,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),oe,e(C,{label:"入库时间"},{default:t(()=>[e(Y,{modelValue:r(m),"onUpdate:modelValue":l[0]||(l[0]=a=>D(m)?m.value=a:m=a),type:"datetimerange","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss","disabled-date":S},null,8,["modelValue"])]),_:1})]),typeCol:t(({scope:o})=>{var a;return[e(g,{type:y((a=o.row)==null?void 0:a.type)},{default:t(()=>{var h;return[d(O(r(K)((h=o.row)==null?void 0:h.type,r(F))),1)]}),_:2},1032,["type"])]}),statusCol:t(({scope:o})=>{var a;return[e(g,{type:P((a=o.row)==null?void 0:a.status)},{default:t(()=>{var h;return[d(O(r(K)((h=o.row)==null?void 0:h.status,r(q))),1)]}),_:2},1032,["type"])]}),operateExpand:t(({rowInfo:o})=>[e(i,{text:"",type:"primary",class:"mini",icon:"View",onClick:a=>{D(_)?_.value=!0:_=!0,D(c)?c.value=o:c=o}},{default:t(()=>[d("明细")]),_:2},1032,["onClick"]),G(e(i,{text:"",type:"primary",class:"mini",icon:"CircleCheck",onClick:a=>b(3,o)},{default:t(()=>[d("通过")]),_:2},1032,["onClick"]),[[E,o.status==r(T).Pending]]),G(e(i,{text:"",type:"primary",class:"mini",icon:"Refresh",onClick:a=>b(2,o)},{default:t(()=>[d("恢复")]),_:2},1032,["onClick"]),[[E,o.status==r(T).recycle]]),o.status==r(T).recycle?(f(),x(N,{key:0,title:"确定永久删除该记录吗？",onConfirm:a=>b(4,o)},{reference:t(()=>[e(i,{text:"",type:"primary",class:"mini",icon:"Delete"},{default:t(()=>[d("永久删除")]),_:1})]),_:2},1032,["onConfirm"])):z("",!0),o.status!=r(T).recycle?(f(),x(N,{key:1,title:"确定加入回收站吗？",onConfirm:a=>b(1,o)},{reference:t(()=>[e(i,{text:"",type:"primary",class:"mini",icon:"Delete"},{default:t(()=>[d("回收站")]),_:1})]),_:2},1032,["onConfirm"])):z("",!0)]),_:1},512),e(le,{dialogVisible:r(_),"onUpdate:dialogVisible":l[1]||(l[1]=o=>D(_)?_.value=o:_=o),infoItem:r(c)},null,8,["dialogVisible","infoItem"])],64)}}});export{ue as default};
