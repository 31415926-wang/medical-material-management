import{E as v,d as X,r as p,w as Z,o as ee,G as U,b as le,a as oe,k as R,g as m,l as e,m as o,u as n,p as te,F as P,v as i,e as h,z as s,H as q,f as F,I as ne,D as ae,t as w,J as ue,K as se,A as de,B as re,L as ie,M as L,N as me,_ as pe}from"./index-5a188929.js";import{M as ce}from"./shareData-091bd6ed.js";const _e=()=>v({url:"/system/menu/tree",method:"get"}),fe=d=>v({url:"/system/menu/add",method:"post",data:d}),ge=d=>v({url:"/system/menu/update/"+d.id,method:"put",data:d}),be=d=>v({url:"/system/menu/delete/"+d,method:"DELETE"}),ve=()=>v({url:"/system/menu/excel",method:"post",responseType:"blob"}),k={getMenuTree:_e,addMenuItem:fe,deleteItem:be,updateItem:ge,exportTable:ve},H=d=>(de("data-v-78b0deb1"),d=d(),re(),d),ye={class:"menu-container"},Ve={class:"filterRow"},he=H(()=>m("h3",{class:"titleRow"},"菜单权限树",-1)),ke={class:"custom-tree-node"},Ne={class:"menu-detail"},xe=H(()=>m("span",{style:{"flex-grow":"1"}},null,-1)),Ce={class:"button-group"},Te=["innerHTML"],Ie={class:"dialog-container"},Ee=X({__name:"index",setup(d){const N=p(""),M=p(),O={children:"children",label:"menuName"};Z(N,u=>{M.value.filter(u)});const A=(u,l)=>u?l.menuName.includes(u):!0;let S=p([]);const B=p([]);ee(()=>{x()});const x=()=>{U.openLoading(document.querySelector(".menu-container")),k.getMenuTree().then(u=>{console.log("菜单数据",u.data),S.value=u.data.open,B.value=u.data.tree,U.closeLoading()}).catch(()=>{U.closeLoading()})},z=async()=>{let u=await k.exportTable();ie(u,"菜单权限"),L("success","导出表格成功!")};let f=p(!1),y=p(!1),V=p(""),a=p({}),$=p();const D=le({menuName:[{required:!0,message:"请输入节点名称",trigger:"blur"}],disabled:[{required:!0,message:"请选择是否可用",trigger:"change"}],open:[{required:!0,message:"请选择是否展开",trigger:"change"}],type:[{required:!0,message:"请选择节点类型",trigger:"change"}]}),C=(u,l)=>{switch(f.value=!0,u){case 0:V.value="添加一级节点",a.value.parentId=0;break;case 1:V.value=`添加节点: 当前<span class="dialogTitle">[${l.menuName}]</span>`,a.value.parentId=l==null?void 0:l.id;break;case 2:V.value=`编辑节点: <span class="dialogTitle">[${l.menuName}]</span>`,console.log("编辑行对象",l),a.value={...l};break}},G=u=>{me(`删除节点[ ${u.menuName} ]`,()=>{k.deleteItem(u.id).then(()=>{L("success",`删除节点${u.menuName}成功！`),x()})})},T=()=>{f.value=!1},j=()=>{$.value.validate().then(()=>{y.value=!0;let u=a.value.id?"updateItem":"addMenuItem";k[u](a.value).then(()=>{L("success","提交成功！"),T(),y.value=!1,x()}).catch(()=>{y.value=!1})})};return oe(()=>{console.log("页面组件销毁")}),(u,l)=>{const g=i("el-input"),c=i("el-button"),J=i("el-button-group"),K=i("el-icon"),_=i("el-form-item"),b=i("el-radio"),I=i("el-radio-group"),Y=i("el-input-number"),Q=i("el-form"),W=i("el-dialog");return h(),R(P,null,[m("div",ye,[m("div",Ve,[e(g,{modelValue:N.value,"onUpdate:modelValue":l[0]||(l[0]=t=>N.value=t),placeholder:"输入关键字进行过滤",clearable:""},null,8,["modelValue"]),e(J,null,{default:o(()=>[e(c,{type:"primary",onClick:l[1]||(l[1]=t=>C(0)),icon:"Plus"},{default:o(()=>[s("添加一级菜单")]),_:1}),e(c,{icon:"Download",onClick:z},{default:o(()=>[s("导出")]),_:1})]),_:1})]),he,e(n(ue),{ref_key:"treeRef",ref:M,data:B.value,props:O,"node-key":"id","default-expanded-keys":n(S),"filter-node-method":A,"highlight-current":""},{default:o(({node:t,data:r})=>[m("div",ke,[m("span",Ne,[e(K,null,{default:o(()=>[n(q)(r.icon)!=""?(h(),F(ne(n(q)(r.icon)),{key:0})):ae("",!0)]),_:2},1024),m("span",null,w(t.label),1),e(c,{disabled:r.disabled,size:"small",type:r.type==0?"primary":"warning",plain:""},{default:o(()=>[s(w(r.type==0?"菜单":`按钮 [ ${r.perms} ]`),1)]),_:2},1032,["disabled","type"])]),xe,m("span",Ce,[e(c,{type:"primary",icon:"Plus",onClick:E=>C(1,r),link:""},{default:o(()=>[s("添加")]),_:2},1032,["onClick"]),e(c,{type:"primary",icon:"EditPen",onClick:E=>C(2,r),link:""},{default:o(()=>[s("编辑")]),_:2},1032,["onClick"]),e(c,{type:"primary",icon:"Delete",onClick:E=>G(r),link:""},{default:o(()=>[s("删除")]),_:2},1032,["onClick"])])])]),_:1},8,["data","default-expanded-keys"])]),e(W,{modelValue:n(f),"onUpdate:modelValue":l[10]||(l[10]=t=>te(f)?f.value=t:f=t),"before-close":T},{header:o(({close:t,titleId:r,titleClass:E})=>[m("span",{innerHTML:n(V)},null,8,Te)]),footer:o(()=>[e(c,{icon:"CloseBold",onClick:T},{default:o(()=>[s(" 取消 ")]),_:1}),e(c,{type:"primary",icon:"Setting",loading:n(y),onClick:j},{default:o(()=>[s("确定")]),_:1},8,["loading"])]),default:o(()=>[m("div",Ie,[e(Q,{ref_key:"menuDialogCheck",ref:$,inline:!1,model:n(a),"label-width":"80px",rules:D},{default:o(()=>[e(_,{label:"节点名称",prop:"menuName"},{default:o(()=>[e(g,{modelValue:n(a).menuName,"onUpdate:modelValue":l[2]||(l[2]=t=>n(a).menuName=t),placeholder:"请输入节点名称"},null,8,["modelValue"])]),_:1}),e(_,{label:"URL",prop:"url"},{default:o(()=>[e(g,{modelValue:n(a).url,"onUpdate:modelValue":l[3]||(l[3]=t=>n(a).url=t),placeholder:"请输入URL"},null,8,["modelValue"])]),_:1}),e(_,{label:"权限编码",prop:"perms"},{default:o(()=>[e(g,{modelValue:n(a).perms,"onUpdate:modelValue":l[4]||(l[4]=t=>n(a).perms=t),placeholder:"请输入权限编码"},null,8,["modelValue"])]),_:1}),e(_,{label:"图标",prop:"icon"},{default:o(()=>[e(g,{modelValue:n(a).icon,"onUpdate:modelValue":l[5]||(l[5]=t=>n(a).icon=t),placeholder:"请输入图标名称"},null,8,["modelValue"])]),_:1}),e(_,{label:"是否可用",prop:"disabled"},{default:o(()=>[e(I,{modelValue:n(a).disabled,"onUpdate:modelValue":l[6]||(l[6]=t=>n(a).disabled=t)},{default:o(()=>[e(b,{value:!0},{default:o(()=>[s("否")]),_:1}),e(b,{value:!1},{default:o(()=>[s("是")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"是否展开",prop:"open"},{default:o(()=>[e(I,{modelValue:n(a).open,"onUpdate:modelValue":l[7]||(l[7]=t=>n(a).open=t)},{default:o(()=>[e(b,{value:0},{default:o(()=>[s("否")]),_:1}),e(b,{value:1},{default:o(()=>[s("是")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"排序",prop:"orderNum"},{default:o(()=>[e(Y,{modelValue:n(a).orderNum,"onUpdate:modelValue":l[8]||(l[8]=t=>n(a).orderNum=t),step:1,"step-strictly":""},null,8,["modelValue"])]),_:1}),e(_,{label:"类型",prop:"type"},{default:o(()=>[e(I,{modelValue:n(a).type,"onUpdate:modelValue":l[9]||(l[9]=t=>n(a).type=t)},{default:o(()=>[(h(!0),R(P,null,se(n(ce),t=>(h(),F(b,{label:t.value},{default:o(()=>[s(w(t.label),1)]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue"])],64)}}});const Le=pe(Ee,[["__scopeId","data-v-78b0deb1"]]);export{Le as default};
