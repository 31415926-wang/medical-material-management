import{d as I,b as P,r as m,o as ee,k as S,l as e,m as a,u as o,p as le,F as q,v as n,e as k,K as ae,z as _,t as v,O as E,g as te,M as B,f as oe,P as G}from"./index-c2dc3635.js";import{i as g}from"./info-a102a412.js";import{i as re}from"./initCrud-4c8d2a0b.js";import{a as M,G as de}from"./shareData-091bd6ed.js";const ue={class:"dialog-footer"},ce=I({__name:"index",setup(ne){const U=P({name:[{required:!0,message:"请输入物资名称",trigger:"blur"}],model:[{required:!0,message:"请填写物资规格",trigger:"blur"}],categoryKeys:[{required:!0,message:"请选择分类",trigger:"blur"}],unit:[{required:!0,message:"请填写单位",trigger:"blur"}],sort:[{required:!0,message:"请填写序号",trigger:"blur"}],remark:[{required:!0,message:"请填写备注信息",trigger:"blur"}]});let N=P([{prop:"name",label:"物资名称",searchType:"input"},{prop:"pnum",label:"物资编号"},{prop:"model",label:"物资规格",rebuild:!0,width:150},{prop:"unit",label:"单位",rebuild:!0,width:150},{prop:"remark",label:"备注"},{prop:"status",label:"状态",rebuild:!0,width:150},{prop:"createTime",label:"创建时间"}]),w=m(),x=m(),V=m();re(V,{title:"物资",apiMethod:g},N);const j=p=>{let r="primary";switch(p){case 0:r="success";break;case 1:r="info";break;case 2:r="warning";break}return r};let b=m([]),L=m({value:"id",label:"name",expandTrigger:"hover",checkStrictly:!0}),T=m({value:"id",label:"name",expandTrigger:"hover"});const R=(p,r)=>{r.categorys=p.join()};let c=m(!1),A=m(!1),d=m({});const h=()=>{c.value=!1,d.value={}},W=async p=>{c.value=!0,console.log("打开编辑框",c.value);let r=await g.getGoodsItem(p);console.log("单行请求的详细数据",r),d.value=r.data,d.value.categoryKeys=[d.value.oneCategoryId,d.value.twoCategoryId,d.value.threeCategoryId],d.value.oneCategoryId=void 0,d.value.twoCategoryId=void 0,d.value.threeCategoryId=void 0},z=async p=>{await g.deleteItem(p),B("success","移入回收站成功"),V.value.hookCrudObject.getData()},H=async()=>{await g.updateItem(d.value),B("success","更新物资成功"),h(),V.value.hookCrudObject.getData()};return ee(async()=>{let p=await g.getCategoryTree();b.value=p.data.rows}),(p,r)=>{const $=n("el-option"),J=n("el-select"),u=n("el-form-item"),C=n("el-cascader"),y=n("el-button"),Q=n("el-popconfirm"),X=n("el-text"),F=n("el-tag"),s=n("el-input"),i=n("el-col"),f=n("el-row"),O=n("el-input-number"),D=n("el-form"),Y=n("CrudTable"),Z=n("el-dialog");return k(),S(q,null,[e(Y,{ref_key:"CrudTableRef",ref:V,needOperate:!0,closeViewDetail:!0,operateColWidth:175,addCheckForm:o(w),editorCheckForm:o(x),operateButtonType:"textType",customOperate:!0,dialogWidths:{add:"32%",editor:"32%",detail:"34%"}},{"search-custom":a(({scope:l})=>[e(u,{label:"物资状态"},{default:a(()=>[e(J,{modelValue:l.searchParam.status,"onUpdate:modelValue":t=>l.searchParam.status=t,placeholder:"请选择物资状态"},{default:a(()=>[(k(!0),S(q,null,ae(o(M),t=>(k(),oe($,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{label:"分类查询"},{default:a(()=>[e(C,{modelValue:l.searchParam.categorys,"onUpdate:modelValue":t=>l.searchParam.categorys=t,onChange:t=>{R(t,l.searchParam)},options:o(b),props:o(L),clearable:"",placeholder:"请选择分类查询"},null,8,["modelValue","onUpdate:modelValue","onChange","options","props"])]),_:2},1024)]),operateExpand:a(({rowInfo:l})=>[e(y,{text:"",type:"primary",class:"mini",icon:"EditPen",onClick:t=>W(l.id)},{default:a(()=>[_("编辑")]),_:2},1032,["onClick"]),e(Q,{title:"确定加入回收站吗？",onConfirm:t=>z(l.id)},{reference:a(()=>[e(y,{text:"",type:"primary",class:"mini",icon:"Delete"},{default:a(()=>[_("回收站")]),_:1})]),_:2},1032,["onConfirm"])]),unitCol:a(({scope:l})=>[e(X,{type:"warning"},{default:a(()=>{var t;return[_(v((t=l.row)==null?void 0:t.unit),1)]}),_:2},1024)]),modelCol:a(({scope:l})=>[e(F,{type:"primary"},{default:a(()=>{var t;return[_(v((t=l.row)==null?void 0:t.model),1)]}),_:2},1024)]),statusCol:a(({scope:l})=>{var t;return[e(F,{type:j((t=l.row)==null?void 0:t.status)},{default:a(()=>{var K;return[_(v(o(de)((K=l.row)==null?void 0:K.status,o(M))),1)]}),_:2},1032,["type"])]}),addForm:a(({formInfo:l})=>[e(D,{ref_key:"addCheckForm",ref:w,model:l,"label-width":"80px",rules:U},{default:a(()=>[e(u,{label:"物资名称",prop:"name"},{default:a(()=>[e(s,{modelValue:l.name,"onUpdate:modelValue":t=>l.name=t,placeholder:"请输入物资名称"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(f,null,{default:a(()=>[e(i,{span:24,lg:10},{default:a(()=>[e(u,{label:"物资规格",prop:"model"},{default:a(()=>[e(s,{modelValue:l.model,"onUpdate:modelValue":t=>l.model=t,placeholder:"请输入规格"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(i,{span:24,lg:14},{default:a(()=>[e(u,{label:"分类",prop:"categoryKeys"},{default:a(()=>[e(C,{modelValue:l.categoryKeys,"onUpdate:modelValue":t=>l.categoryKeys=t,options:o(b),props:o(T),clearable:"",placeholder:"请选择分类"},null,8,["modelValue","onUpdate:modelValue","options","props"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(f,null,{default:a(()=>[e(i,{span:24,lg:10},{default:a(()=>[e(u,{label:"单位",prop:"unit"},{default:a(()=>[e(s,{modelValue:l.unit,"onUpdate:modelValue":t=>l.unit=t,placeholder:"请填写单位"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(i,{span:24,lg:14},{default:a(()=>[e(u,{label:"排序",prop:"sort"},{default:a(()=>[e(O,{modelValue:l.sort,"onUpdate:modelValue":t=>l.sort=t,min:1,placeholder:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(u,{label:"备注信息",prop:"remark"},{default:a(()=>[e(s,{type:"textarea",modelValue:l.remark,"onUpdate:modelValue":t=>l.remark=t,placeholder:"请输入备注信息"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),E(e(u,{label:"",prop:""},{default:a(()=>[e(s,{modelValue:l.imageUrl,"onUpdate:modelValue":t=>l.imageUrl=t},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1536),[[G,!1]])]),_:2},1032,["model","rules"])]),_:1},8,["addCheckForm","editorCheckForm"]),e(Z,{modelValue:o(c),"onUpdate:modelValue":r[7]||(r[7]=l=>le(c)?c.value=l:c=l),title:"编辑物资",width:"32%","before-close":h},{footer:a(()=>[te("span",ue,[e(y,{onClick:h},{default:a(()=>[_(" 关闭 ")]),_:1}),e(y,{type:"primary",loading:o(A),onClick:H},{default:a(()=>[_("提交")]),_:1},8,["loading"])])]),default:a(()=>[e(D,{ref_key:"editorCheckForm",ref:x,model:o(d),"label-width":"80px",rules:U},{default:a(()=>[e(u,{label:"物资名称",prop:"name"},{default:a(()=>[e(s,{modelValue:o(d).name,"onUpdate:modelValue":r[0]||(r[0]=l=>o(d).name=l),placeholder:"请输入物资名称"},null,8,["modelValue"])]),_:1}),e(f,null,{default:a(()=>[e(i,{span:24,lg:10},{default:a(()=>[e(u,{label:"物资规格",prop:"model"},{default:a(()=>[e(s,{modelValue:o(d).model,"onUpdate:modelValue":r[1]||(r[1]=l=>o(d).model=l),placeholder:"请输入规格"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24,lg:14},{default:a(()=>[e(u,{label:"分类",prop:"categoryKeys"},{default:a(()=>[e(C,{modelValue:o(d).categoryKeys,"onUpdate:modelValue":r[2]||(r[2]=l=>o(d).categoryKeys=l),options:o(b),props:o(T),clearable:"",placeholder:"请选择分类"},null,8,["modelValue","options","props"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(i,{span:24,lg:10},{default:a(()=>[e(u,{label:"单位",prop:"unit"},{default:a(()=>[e(s,{modelValue:o(d).unit,"onUpdate:modelValue":r[3]||(r[3]=l=>o(d).unit=l),placeholder:"请填写单位"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24,lg:14},{default:a(()=>[e(u,{label:"排序",prop:"sort"},{default:a(()=>[e(O,{modelValue:o(d).sort,"onUpdate:modelValue":r[4]||(r[4]=l=>o(d).sort=l),min:1,placeholder:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(u,{label:"备注信息",prop:"remark"},{default:a(()=>[e(s,{type:"textarea",modelValue:o(d).remark,"onUpdate:modelValue":r[5]||(r[5]=l=>o(d).remark=l),placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1}),E(e(u,{label:"",prop:""},{default:a(()=>[e(s,{modelValue:o(d).imageUrl,"onUpdate:modelValue":r[6]||(r[6]=l=>o(d).imageUrl=l)},null,8,["modelValue"])]),_:1},512),[[G,!1]])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}});export{ce as default};
